{% extends "basebuildpage.html" %}
{% load projecttags %}
{% block localbreadcrumb %}
<li>{{title}}</li>
{% endblock %}

{% block buildinfomain %}
<div class="span10">
<div class="page-header">
<h1>
  {% if request.GET.filter or request.GET.search and objects.count > 0  %}
      {{objects.paginator.count}} task{{objects.paginator.count|pluralize}} found
  {%elif objects.paginator.count == 0%}
      No tasks
  {%else%}
      {{title}}
  {%endif%}
 </h1>
</div>

{% if objects.paginator.count == 0 %}
  <div class="row-fluid">
      <div class="alert">
        <form class="no-results input-append" id="searchform">
            <input id="search" name="search" class="input-xxlarge" type="text" value="{{request.GET.search}}"/>{% if request.GET.search %}<a href="javascript:$('#search').val('');searchform.submit()" class="add-on btn" tabindex="-1"><i class="icon-remove"></i></a>{% endif %}
            <button class="btn" type="submit" value="Search">Search</button>
            <button class="btn btn-link" onclick="javascript:$('#search').val('');searchform.submit()">Show all tasks</button>
        </form>
      </div>
  </div>


{% else %}
{% include "basetable_top.html" %}

    {% for task in objects %}
        <tr {{ task|task_color }} class="flash" id="{{task.order}}" name="{{task.order}}">
            <td class="order">
                <a href="{%url "task" build.pk task.pk%}">{{task.order}}</a>
            </td>
            <td class="recipe_name" >
                <a href="{% url "recipe" build.pk task.recipe.pk %}">{{task.recipe.name}}</a>
            </td>
            <td class="recipe_version">
                <a href="{% url "recipe" build.pk task.recipe.pk %}">{{task.recipe.version}}</a>
            </td>
            <td class="task_name">
                <a href="{%url "task" build.pk task.pk%} ">{{task.task_name}}</a>
            </td>
            <td class="executed">
                <a href="{%url "task" build.pk task.pk%} ">{{task.get_executed_display}}</a>
            </td>
            <td class="outcome">
                <a href="{%url "task" build.pk task.pk%} ">{{task.get_outcome_display}}</a>
            </td>
            <td class="cache_attempt">
                <a href="{%url "task" build.pk task.pk%} ">{{task.get_sstate_result_display|format_none_and_zero}}</a>
            </td>
            <td class="time_taken">
                {{task.elapsed_time|format_none_and_zero|floatformat:2}}
            </td>
            <td class="cpu_used">
                {{task.cpu_usage|format_none_and_zero|floatformat:2}}{% if task.cpu_usage %}%{% endif %}
            </td>
            <td class="disk_io">
                {{task.disk_io|format_none_and_zero}}
            </td>
            <td class="task_log">
                {{task.logfile}}
            </td>
        </tr>
    {% endfor %}

{% include "basetable_bottom.html" %}
{% endif %}
</div>
{% endblock %}
